<div class="container">
    <h1>Mon <span class="green">profil</span></h1>

    <div class="card">
        <div class="card-header">
            <div class="info">
                <h2><span class="green">Mes informations</span></h2>
            </div>
        </div>
        <div class="card-body">
            <div class="container loading" [hidden]="utilisateur">
                <img src="assets/img/loading.gif">
                <span>Chargement en cours...</span>
            </div>
            <form [formGroup]="userForm" (ngSubmit)="editing()">
                <div *ngIf="utilisateur" class="row">
                        <div class="col-4">
                            <div class="details">
                                <h5>Nom</h5>
                                <span [hidden]='isEditing'>{{ utilisateur.nom }}</span>
                                <input [hidden]='!isEditing' formControlName="nom" value="{{ utilisateur.nom }}">
                            </div>
                            <div class="details">
                                <h5>Prénom</h5>
                                <span [hidden]='isEditing'>{{ utilisateur.prenom }}</span>
                                <input [hidden]='!isEditing' formControlName="prenom" value="{{ utilisateur.prenom }}">
                            </div>
                            <div class="details">
                                <h5>Email</h5>
                                <span [hidden]='isEditing'>{{ utilisateur.mail }}</span>
                                <input [hidden]='!isEditing' formControlName="mail" value="{{ utilisateur.mail }}">
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="details">
                                <h5>Téléphone</h5>
                                <span [hidden]="isEditing">{{ utilisateur.telephone }}</span>
                                <input [hidden]="!isEditing" formControlName="telephone" value="{{ utilisateur.telephone }}">
                            </div>
                            <div class="details">
                                <h5>Adresse</h5>
                                <span [hidden]="isEditing">{{ utilisateur.adresse }}</span>
                                <input [hidden]="!isEditing" formControlName="adresse"  value="{{ utilisateur.adresse }}">
                            </div>
                            <div class="details">
                                <h5>Ville</h5>
                                <span [hidden]="isEditing">{{ utilisateur.ville.ville }}</span>
                                <input [hidden]="!isEditing" formControlName="ville" value="{{ utilisateur.ville.ville }}">
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="details">
                                <h5>Catégorie</h5>
                                <span [hidden]="isEditing">{{ utilisateur.categorie.categorie }}</span>
                                <input [hidden]="!isEditing" formControlName="categorie" value="{{ utilisateur.categorie.categorie }}">
                            </div>
                            <div class="details" [hidden]="!isEditing">
                                <h5>Mot de passe</h5>
                                <input formControlName="password">
                            </div>
                        </div>
                        <div class="button-row">
                            <button type="button" class="ok" [hidden]="isEditing" (click)="changeIsEditing(true)">Modifier</button>
                            <button type="button" class="ko" [hidden]="!isEditing" (click)="changeIsEditing(false)">Annuler</button>
                            <button type="submit" class="ok" [hidden]="!isEditing || editingStatus == 'LOADING'" [disabled]="userForm.invalid">Sauvegarder</button>
                            <button class="ok loading-button" [hidden]="!isEditing || editingStatus != 'LOADING'" disabled>
                                <img src="assets/img/loading.gif">
                                <span>Traitement...</span>
                            </button>
                        </div>

                    <div class="alert alert-success" role="alert" *ngIf="editingStatus == 'SUCCESS' && isEditing">
                        Vos modifications ont bien été enregistrées !
                    </div>
                    <div class="alert alert-danger" role="alert" *ngIf="editingStatus == 'ERROR' && isEditing">
                        <h6 class="alert-heading">Une ou plusieurs erreurs sont survenues</h6>
                        <ul *ngIf="isArray(editingResponse)">
                            <li *ngFor="let err of editingResponse">{{ err }}</li>
                        </ul>
                    </div>
                </div>
            </form>
            <div [hidden]="!isEditing"> {{ afficheText }}</div>
        </div>
    </div>
</div>